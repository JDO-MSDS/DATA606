---
title: "Data 606 Lab5A"
author: "Joao De Oliveira"
date: "2025-10-09"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Overview
In this lab, I will investigate the ways in which the statistics from a random sample of data can serve as point estimates for population parameters. I will be formulating a sampling distribution of my estimate in order to learn about the properties of the estimate, such as its distribution.


### Load Packages

```{r packages}
library(tidyverse)
library(openintro)
library(infer)
```


### Data

```{r data}
set.seed(1234)

global_monitor <- tibble(
  scientist_work = c(rep("Benefits", 80000), rep("Doesn't benefit", 20000))
)

ggplot(global_monitor, aes(x = scientist_work)) +
  geom_bar() +
  labs(
    x = "", y = "",
    title = "Do you believe that the work scientists do benefit people like you?"
  ) +
  coord_flip() 

# summary stats
global_monitor %>%
  count(scientist_work) %>%
  mutate(p = n /sum(n))

# sample
samp1 <- global_monitor %>%
  sample_n(50)
```


### Exercise 1
Describe the distribution of responses in this sample. How does it compare to the distribution of responses in the population. Hint: Although the sample_n function takes a random sample of observations (i.e. rows) from the dataset, you can still refer to the variables in the dataset with the same names. Code you presented earlier for visualizing and summarizing the population data will still be useful for the sample, however be careful to not label your proportion p since you’re now calculating a sample statistic, not a population parameters. You can customize the label of the statistics to indicate that it comes from the sample.


```{r exercise1}
ggplot(samp1, aes(x = scientist_work)) +
  geom_bar() +
  labs(
    x = "", y = "Count",
    title = "Scientists' work benefits you?") +
  coord_flip()

# sample summary stats
sample_summary <- samp1 %>%
  count(scientist_work) %>%
  mutate(p_hat = n / sum(n))

sample_summary
```

### Answer 1
The distribution of responses in the sample differs slightly from the population distribution. While the population shows an 80/20 split between those who believe the work of scientists benefits them and those who do not, the sample of 50 participants shows a different proportion of approximately 86% versus 14%. This difference is visible in the bar plots, where the bars for the sample are not perfectly aligned with those of the population. Such variation is expected due to random sampling — each sample may slightly over represent or under represent certain possibilities.


### Exercise 2
Would you expect the sample proportion to match the sample proportion of another student’s sample? Why, or why not? If the answer is no, would you expect the proportions to be somewhat different or very different? Ask a student team to confirm your answer.


### Answer 2
I would not expect my sample proportion to be exactly the same as another student’s sample proportion. Each student’s sample is randomly drawn from the same population, so the specific individuals chosen won't be the same. Because of this random variation, the sample proportions (p_hat) will differ. However, I would expect the differences between our sample proportions to be somewhat small, not very large. Since both samples come from the same large population (where the true proportion p = 20), most random samples of size 50 should give sample proportions that are close to 0.20, though not identical. When I compared results, the sample proportions were slightly different but within a few percentage points, confirming that small variation is normal and expected due to random sampling. Different seeds will also give different outcomes.

### Exercise 3
Take a second sample, also of size 50, and call it samp2. How does the sample proportion of samp2 compare with that of samp1? Suppose we took two more samples, one of size 100 and one of size 1000. Which would you think would provide a more accurate estimate of the population proportion?

```{r exercise3}
samp2 <- global_monitor %>% sample_n(50)

p_hat1 <- mean(samp1$scientist_work == "Doesn't benefit")
p_hat2 <- mean(samp2$scientist_work == "Doesn't benefit")

# compare
tibble(
  sample = c("samp1 (n=50)", "samp2 (n=50)"),
  p_hat   = c(p_hat1, p_hat2)
)

# Larger samples
samp100 <- global_monitor %>% sample_n(100)
samp1000 <- global_monitor %>% sample_n(1000)

p_hat100 <- mean(samp100$scientist_work == "Doesn't benefit")
p_hat1000 <- mean(samp1000$scientist_work == "Doesn't benefit")

results <- tibble(
  sample = c("samp1 (n=50)", "samp2 (n=50)", "samp3 (n=100)", "samp4 (n=1000)"),
  p_hat  = c(p_hat1, p_hat2, p_hat100, p_hat1000),
  abs_error = abs(p_hat - 0.20)  # deviation from true p = 0.20
)

results
```

### Answer 3
We can see that the sample proportion in sample 1 and sample 2 are different despite both samples having the same size (50). This happens because since the samples are different, there are different representations of the population due to randomness. Samples 3 and 4 will have a better representation of the entire population because they are larger Sample 4, with 1000, is the largest sample size and that also explains why the proportion is pretty close to the population p (0.186 ~ 0.2). 


### Exercise 4
How many elements are there in sample_props50? Describe the sampling distribution, and be sure to specifically note its center. Make sure to include a plot of the distribution in your answer.

```{r exercise4}
sample_props50 <- global_monitor %>%
                    rep_sample_n(size = 50, reps = 15000, replace = TRUE) %>%
                    count(scientist_work) %>%
                    mutate(p_hat = n /sum(n)) %>%
                    filter(scientist_work == "Doesn't benefit")

ggplot(data = sample_props50, aes(x = p_hat)) +
  geom_histogram(binwidth = 0.02) +
  labs(
    x = "p_hat (Doesn't benefit)",
    title = "Sampling distribution of p_hat",
    subtitle = "Sample size = 50, Number of samples = 15000"
  )

# finding num of elements
nrow(sample_props50)
```

### Answer 4
sample_props50 has 15000 elements since we are taking one element (the p of not benefiting from scientists work) from each sample of size 50. By looking at the sampling distribution we see that the mean (center) is 0.2, as expected and the distribution has a shape similar to a bell-shaped distribution (normal distribution). The great majority of the values is between 0.1 and 0.3. 


### Exercise 5
To make sure you understand how sampling distributions are built, and exactly what the rep_sample_n function does, try modifying the code to create a sampling distribution of 25 sample proportions from samples of size 10, and put them in a data frame named sample_props_small. Print the output. How many observations are there in this object called sample_props_small? What does each observation represent?

```{r exercise5}
sample_props_small <- global_monitor %>%
                    rep_sample_n(size = 10, reps = 25, replace = TRUE) %>%
                    count(scientist_work) %>%
                    mutate(p_hat = n /sum(n)) %>%
                    filter(scientist_work == "Doesn't benefit")

# print the data frame
sample_props_small

# number of observations
nrow(sample_props_small)

```

### Answer 5
The number of observations in the 25 reps with size 10 each was 21, which is not what I was expecting (25). However, this is probably due to the fact that some of them will have probability of success ("doesn't benefit) equal to 0, which is not that far from 0.2. So, 4 of the 25 samples got probability equal to zero (everyone in those 4 samples believed that scientist benefit them). So, each observation represent the sample proportion of peple who do not believe scientists benefit them (if not zero).


### Exercise 6



